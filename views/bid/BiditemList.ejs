<html>
    <head>
        <title></title>
        <% include ../source.ejs%>

        <script>
            $(function() {
                $('#addItem').click( function() {
                    loginCheck()
                    .catch( function(err) { console.log(err); } )
                    .then( function() { location.href = "/bid/additem"; } );
                    });
            });

            function loginCheck() {
                return new Promise( function(resolve, reject) {
                    console.log('logincheck promise');
                    $.ajax({
                        url : '/auth/logincheck',
                        type : 'get',
                        datatype : 'text',

                        success : function(result) {
                            var _result = $.trim(result);
                            if(_result === 'true') {
                                resolve();
                            }
                            else {
                                alert('로그인 후 이용 가능합니다.');
                            }
                        }
                    })
                })
            }
        </script>

    </head>

    <body>
    <%- include('../navbar.ejs', { html : ui });%>
    <section class="page-section">
        <div class="container shadow-sm p-5">
            <div class="row">
                <div class="col">
                    <p><h5>경매장</h5></p>
                    <hr class="custom-hr">
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-6 col-md-6 col-sm-6">
                    <p class="bid-item">
                    </p>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6">
                    <% include ./BidSerachBar.ejs%>
                </div>
            </div>
            <div class="row mt-5 mb-5"  id="itemContainer">

                <%for(var i=0; i < list.length; i++) { %>
                <div class="col-lg-3 col-md-4 col-sm-6 bid-item mb-5 shadow-sm">
                    <a href="/bid/item/<%= list[i].item_no%>">
                        <img class="img-fluid rounded" src="<%= list[i].item_image_src%>" style="width : 200px; height : 200px; object-fit: cover; overflow: hidden">
                    </a>
                    <p class="mt-3 text-center"><%= list[i].item_name%></p>
                    <p><span class="bid-item-sub mr-2">시작가</span><%= list[i].item_start_price%>원</p>
                    <p><span class="bid-item-sub mr-2">최고가</span><%= list[i].item_max_price%>원</p>
                    <p><span class="bid-item-sub mr-2">현재 입찰가</span><%= list[i].item_current_price%>원</p>


                </div>
                <% } %>
            </div>

            <div class="row justify-content-around">
                <div class="col-lg-2 col-md-2 col-sm-2"></div>
                <div class="col-lg-2 col-md-2 col-sm-2">
                    <button class="btn btn-block btn-primary" type="button" id="moreBtn"><i class="fas fa-angle-down"></i>더보기</button>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2">
                    <button class="btn btn-secondary" id="addItem">상품 등록</button>
                </div>
            </div>

        </div>
    </section>

    <% include ../footer.ejs%>
    </body>
</html>
